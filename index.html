<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wireless Communication Experiments - Complete Collection</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        nav {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 2px solid #e9ecef;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .nav-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .content {
            padding: 40px;
        }
        
        .experiment {
            margin-bottom: 50px;
            border-left: 4px solid #667eea;
            padding-left: 30px;
        }
        
        .experiment h2 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .experiment h3 {
            color: #764ba2;
            font-size: 1.5em;
            margin: 20px 0 10px 0;
        }
        
        .aim {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-style: italic;
            color: #333;
        }
        
        .code-container {
            position: relative;
            margin: 20px 0;
        }
        
        .code-header {
            background: #2d3748;
            color: white;
            padding: 10px 15px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .copy-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 6px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.3s;
        }
        
        .copy-btn:hover {
            background: #764ba2;
        }
        
        .copy-btn.copied {
            background: #48bb78;
        }
        
        pre {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0;
            line-height: 1.6;
        }
        
        code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }
        
        .output {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .output h4 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .output pre {
            background: white;
            color: #2d3748;
            border: 1px solid #e2e8f0;
            padding: 15px;
        }
        
        footer {
            background: #2d3748;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
            
            .experiment {
                padding-left: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ðŸ“¡ Wireless Communication Experiments</h1>
            <p>Complete MATLAB Code Collection</p>
        </header>
        
        <nav>
            <div class="nav-grid">
                <button class="nav-btn" onclick="scrollToExp(1)">Exp 1: Friis Equation</button>
                <button class="nav-btn" onclick="scrollToExp(2)">Exp 2: Two Ray Model</button>
                <button class="nav-btn" onclick="scrollToExp(3)">Exp 3: Okumura Model</button>
                <button class="nav-btn" onclick="scrollToExp(4)">Exp 4: Hata Model</button>
                <button class="nav-btn" onclick="scrollToExp(5)">Exp 5: Rayleigh BER</button>
                <button class="nav-btn" onclick="scrollToExp(6)">Exp 6: Multipath Fading</button>
                <button class="nav-btn" onclick="scrollToExp(7)">Exp 7: TDMA/FDMA/CDMA</button>
                <button class="nav-btn" onclick="scrollToExp(8)">Exp 8: Delay Spread</button>
                <button class="nav-btn" onclick="scrollToExp(9)">Exp 9: Baseband Sim</button>
            </div>
        </nav>
        
        <div class="content">
            <!-- EXPERIMENT 1 -->
            <div class="experiment" id="exp1">
                <h2>EXPERIMENT 1</h2>
                <div class="aim">
                    <strong>Aim:</strong> To analyze the Path Loss and Received Power Using Friis Transmission Equation.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clc; clear; close all;
Pt = input('Enter transmitted power Pt (in Watts): ');
Gt = input('Enter transmitter gain Gt: ');
Gr = input('Enter receiver gain Gr: ');
r = input('Enter distance r (in meters): ');
f = input('Enter frequency f (in Hz): ');
c = 3e8;
lambda = c ./ f;
Pr = (Pt .* Gt .* Gr .* (lambda.^2)) ./ ((4 * pi * r).^2);
PL = ((4 * pi * r) ./ lambda).^2;
fprintf('\nWavelength (lambda): %.4e m\n', lambda);
fprintf('Received Power (Pr): %.4e W\n', Pr);
fprintf('Path Loss (PL): %.4e\n', PL);
fran = linspace(1e8, 10e9, 1000);
rran = linspace(1, 1000, 1000);
lambdaf = c ./ fran;
lambdar = c ./ f;
PL_f = ((4 * pi * r) ./ lambdaf).^2;
PL_r = ((4 * pi * rran) ./ lambdar).^2;
Pr_f = (Pt .* Gt .* Gr .* (lambdaf.^2)) ./ ((4 * pi * r).^2);
Pr_r = (Pt .* Gt .* Gr .* (lambdar.^2)) ./ ((4 * pi * rran).^2);
figure;
subplot(2,2,1);
plot(fran, 10*log10(PL_f));
xlabel('Frequency (Hz)'); ylabel('Path Loss (dB)');
title('Frequency vs Path Loss'); grid on;
subplot(2,2,2);
plot(rran, 10*log10(PL_r));
xlabel('Distance r (m)'); ylabel('Path Loss (dB)');
title('Distance vs Path Loss'); grid on;
subplot(2,2,3);
plot(fran, 10*log10(Pr_f));
xlabel('Frequency (Hz)'); ylabel('Received Power (dB)');
title('Frequency vs Received Power'); grid on;
subplot(2,2,4);
plot(rran, 10*log10(Pr_r));
xlabel('Distance r (m)'); ylabel('Received Power (dB)');
title('Distance vs Received Power'); grid on;</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>Enter transmitted power Pt (in Watts): 50
Enter transmitter gain Gt: 1
Enter receiver gain Gr: 1
Enter distance r (in meters): 100
Enter frequency f (in Hz): 900e6
Wavelength (lambda): 3.3333e-01 m
Received Power (Pr): 3.5181e-06 W
Path Loss (PL): 1.4212e+07</pre>
                </div>
            </div>

            <!-- EXPERIMENT 2 -->
            <div class="experiment" id="exp2">
                <h2>EXPERIMENT 2</h2>
                <div class="aim">
                    <strong>Aim:</strong> To design a Two Ray Transmission Model.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clc; clear; close all;
Pt = input('Enter transmitted power Pt (in Watts): ');
Gt = input('Enter transmitter gain Gt: ');
Gr = input('Enter receiver gain Gr: ');
ht = input('Enter transmitter height ht: ');
hr = input('Enter receiver height hr: ');
d = input('Enter distance d: ');
tworay_Pr = (Pt * Gt * Gr * ((ht*hr) / d^2)^2)
rran = linspace(1, 6000, 10000);
tworay_Pr = Pt * Gt * Gr * ((ht*hr).^2 ./ rran.^4);
plot(rran, 10*log10(tworay_Pr));
xlabel('Distance'); ylabel('Two Ray Received Power (dB)');
title('Distance vs Received Power');
legend('Two Ray Model');</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>Enter transmitted power Pt (in Watts): 13
Enter transmitter gain Gt: 2.55
Enter receiver gain Gr: 1
Enter transmitter height ht: 50
Enter receiver height hr: 1.5
Enter distance d: 5e3
tworay_Pr = 2.9835e-10</pre>
                </div>
            </div>

            <!-- EXPERIMENT 3 -->
            <div class="experiment" id="exp3">
                <h2>EXPERIMENT 3</h2>
                <div class="aim">
                    <strong>Aim:</strong> To design an Okumura Model.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clc; clear all;
f = input('Enter frequency f: ');
d = input('Enter distance d: ');
ht = input('Enter transmitter height ht: ');
hr = input('Enter receiver height hr: ');
a = input('Enter median attenuation a: ');
gA = input('Enter area gain gA (dB): ');

Lf = 20*log10(((3*10^8)/f)./(4*pi*d));

if ht > 30 && ht < 1000
    ght = 20*log10(ht/200);
else
    ght = 0;
end

fprintf('Free space path loss = %.7f\n', Lf);
fprintf('Transmitter height gain = %.4f\n', ght);</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>Enter frequency f: 900000000
Enter distance d: 50000
Enter transmitter height ht: 100
Enter receiver height hr: 10
Enter median attenuation a: 43
Enter area gain gA (dB): 9
Free space path loss = 125.5060225
Median path loss(50%) = 165.5266</pre>
                </div>
            </div>

            <!-- EXPERIMENT 4 -->
            <div class="experiment" id="exp4">
                <h2>EXPERIMENT 4</h2>
                <div class="aim">
                    <strong>Aim:</strong> To implement the Hata Model for Path Loss Prediction.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clc; clear; close all;
f = input('Enter frequency in MHz (150 - 1500): ');
hb = input('Enter base station antenna height in meters (30 - 200): ');
hm = input('Enter mobile station antenna height in meters (1 - 10): ');
area = input('Enter environment type (urban, suburban, open): ', 's');

if f < 150 || f > 1500
    error('Frequency out of range (150-1500 MHz)');
end
if hb < 30 || hb > 200
    error('Base station antenna height out of range (30-200 m)');
end
if hm < 1 || hm > 10
    error('Mobile station antenna height out of range (1-10 m)');
end

valid_areas = {'urban', 'suburban', 'open'};
if ~ismember(lower(area), valid_areas)
    error('Invalid environment type. Choose urban, suburban, or open');
end

d = 1:1:20;
a_hm = (1.1*log10(f) - 0.7)*hm - (1.56*log10(f) - 0.8);

switch lower(area)
    case 'urban'
        C = 0;
    case 'suburban'
        C = -2*(log10(f/28))^2 - 5.4;
    case 'open'
        C = -4.78*(log10(f))^2 + 18.33*log10(f) - 40.94;
end

L = 69.55 + 26.16*log10(f) - 13.82*log10(hb) - a_hm + ...
    (44.9 - 6.55*log10(hb)).*log10(d) + C;

figure;
plot(d, L, 'b-', 'LineWidth', 2);
grid on;
xlabel('Distance (km)');
ylabel('Path Loss (dB)');
title(sprintf('Hata Model Path Loss vs Distance at %d MHz (%s)', f, area));
xlim([1 20]);
ylim([min(L)-10 max(L)+10]);
legend('Hata Model');

fprintf('Hata model path loss computed for frequency %d MHz and environment (%s)\n', f, area);</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>Enter frequency in MHz (150 - 1500): 900
Enter base station antenna height in meters (30 - 200): 100
Enter mobile station antenna height in meters (1 - 10): 10
Enter environment type (urban, suburban, open): suburban
Hata model path loss computed for frequency 900 MHz and environment (suburban)</pre>
                </div>
            </div>

            <!-- EXPERIMENT 5 -->
            <div class="experiment" id="exp5">
                <h2>EXPERIMENT 5</h2>
                <div class="aim">
                    <strong>Aim:</strong> To calculate BER of Multipath Rayleigh Fading Channel.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clear; clc; close all;
%% Parameters
numBits = 1e5; % Number of bits
M = 2; % Modulation order (2=BPSK, 4=QPSK)
EbN0dB = 0:2:20; % SNR range
numPaths = 3; % Multipath components
fadePowerdB = [0 -3 -6]; % Path power profile in dB
delays = [0 2 4]; % Path delays in samples

% Convert to linear
pathGains = 10.^(fadePowerdB/10);

%% Generate random bits and modulate
bits = randi([0 M-1], numBits, 1);
if M == 2
    txSymbols = pskmod(bits, M); % BPSK
else
    txSymbols = pskmod(bits, M, pi/4); % QPSK
end

%% Loop over Eb/N0
berSim = zeros(size(EbN0dB));
for snrIdx = 1:length(EbN0dB)
    % Convert Eb/N0 to noise variance
    EbN0 = 10^(EbN0dB(snrIdx)/10);
    noiseVar = 1/(2*EbN0);
    
    % Generate fading channel
    h = zeros(numPaths, numBits);
    for p = 1:numPaths
        h(p,:) = sqrt(pathGains(p)/2) * ...
            (randn(1,numBits) + 1i*randn(1,numBits));
    end
    
    % Pass through multipath fading channel
    rxSig = zeros(1, numBits+max(delays));
    for p = 1:numPaths
        rxSig(delays(p)+1:delays(p)+numBits) = ...
            rxSig(delays(p)+1:delays(p)+numBits) + h(p,:) .* txSymbols.';
    end
    
    % Add AWGN
    noise = sqrt(noiseVar) * (randn(size(rxSig)) + 1i*randn(size(rxSig)));
    rxSig = rxSig + noise;
    
    % For simplicity â†’ take first path only (flat fading assumption)
    rxFlat = rxSig(1:numBits);
    
    % Equalization (remove fading effect by division)
    rxEq = rxFlat.' ./ (h(1,:).');
    
    % Demodulate
    rxBits = pskdemod(rxEq, M, pi*(M==4)/4);
    
    % BER calculation
    berSim(snrIdx) = sum(bits ~= rxBits) / numBits;
end

%% Plot BER Curve
figure;
semilogy(EbN0dB, berSim, 'bo-','LineWidth',1.5); hold on;
grid on;
EbN0 = 10.^(EbN0dB/10);

% Theoretical BER (BPSK Rayleigh fading)
if M == 2
    berTheory = 0.5*(1 - sqrt(EbN0./(1+EbN0)));
    semilogy(EbN0dB, berTheory, 'r--','LineWidth',1.5);
    legend('Simulated BER','Theoretical BER (Rayleigh)');
else
    legend('Simulated BER');
end

xlabel('Eb/N0 (dB)');
ylabel('Bit Error Rate (BER)');
title('BER Performance over Multipath Rayleigh Fading Channel');</code></pre>
                </div>
            </div>

            <!-- EXPERIMENT 6 -->
            <div class="experiment" id="exp6">
                <h2>EXPERIMENT 6</h2>
                <div class="aim">
                    <strong>Aim:</strong> To develop a Multipath Rayleigh Fading Channel.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>%% Multipath Rayleigh Fading Channel Simulation
clear; clc; close all;

%% Simulation Parameters
numSamples = 2000; % Number of samples
numPaths = 4; % Number of multipath components
fadePower = [0 -3 -6 -9]; % Path power in dB (relative)
delays = [0 2 4 7]; % Path delays in samples

% Convert power from dB to linear
pathGains = 10.^(fadePower/10);

%% Generate Rayleigh fading coefficients (time-varying)
h = zeros(numPaths, numSamples);
for p = 1:numPaths
    h(p,:) = sqrt(pathGains(p)/2) * ...
        (randn(1,numSamples) + 1i*randn(1,numSamples));
end

%% Generate Transmit Signal (QPSK symbols for demo)
M = 4; % QPSK
data = randi([0 M-1], 1, numSamples);
txSignal = pskmod(data, M, pi/4); % Gray-coded QPSK

%% Apply Multipath Fading Channel
rxSignal = zeros(1, numSamples + max(delays));
for p = 1:numPaths
    rxSignal(delays(p)+1:delays(p)+numSamples) = ...
        rxSignal(delays(p)+1:delays(p)+numSamples) + ...
        h(p,:) .* txSignal;
end

%% Plot Results
t = 1:numSamples;

% 1. Transmitted vs Received signals
figure;
subplot(2,1,1);
plot(real(txSignal(1:200)), 'b'); hold on;
plot(imag(txSignal(1:200)), 'r');
title('Transmitted QPSK Signal (first 200 samples)');
legend('In-phase','Quadrature');
xlabel('Samples'); ylabel('Amplitude');

subplot(2,1,2);
plot(real(rxSignal(1:200)), 'b'); hold on;
plot(imag(rxSignal(1:200)), 'r');
title('Received Signal after Multipath Fading (first 200 samples)');
legend('In-phase','Quadrature');
xlabel('Samples'); ylabel('Amplitude');

% 2. Channel Impulse Response (snapshot)
figure;
stem(delays, sqrt(pathGains), 'filled');
title('Channel Power Delay Profile');
xlabel('Delay (samples)'); ylabel('Relative Gain');

% 3. Frequency Response of the Channel
Hf = fft(sum(h,1), 512);
f = linspace(-0.5,0.5,length(Hf));
figure;
plot(f, 20*log10(abs(fftshift(Hf))));
title('Frequency Response of Multipath Channel');
xlabel('Normalized Frequency'); ylabel('Magnitude (dB)'); grid on;

% 4. Received Constellation
figure;
plot(real(rxSignal(500:end)), imag(rxSignal(500:end)), '.');
title('Received Signal Constellation under Multipath Fading');
xlabel('In-phase'); ylabel('Quadrature'); grid on;</code></pre>
                </div>
            </div>

            <!-- EXPERIMENT 7 -->
            <div class="experiment" id="exp7">
                <h2>EXPERIMENT 7</h2>
                <div class="aim">
                    <strong>Aim:</strong> To model and simulate TDMA, FDMA and CDMA for wireless communication.
                </div>
                
                <h3>Part 1: TDMA - Time Division Multiple Access</h3>
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>% TDMA Simulation
clc; clear; close all;

% Step 1: Define System Parameters
numUsers = 4;
timeSlotDuration = 1; % seconds
totalTimeSlots = 10;
channelGain = 0.8;

% Step 2: Generate User Traffic
userData = randi([0, 1], numUsers, totalTimeSlots);

% Step 3: Create Time Slots
timeSlots = linspace(0, timeSlotDuration*totalTimeSlots, totalTimeSlots);

% Step 4: Allocate Time Slots to Users
userSlots = mod(0:totalTimeSlots-1, numUsers) + 1;

% Step 5: Simulate Transmission
receivedData = zeros(numUsers, totalTimeSlots);
for slot = 1:totalTimeSlots
    for user = 1:numUsers
        if userSlots(slot) == user
            % Simulate transmission for the current user in the time slot
            transmittedData = userData(user, slot);
            % Simulate channel effects
            receivedData(user, slot) = transmittedData * channelGain;
        end
    end
end

% Step 6: Evaluate Performance Metrics (e.g., BER)
bitErrorRate = sum(sum(xor(receivedData, userData))) / (numUsers * totalTimeSlots);

% Step 7: Visualize Results
figure;
subplot(2, 1, 1);
stem(timeSlots, userData');
title('User Traffic');
xlabel('Time (s)'); ylabel('Data');
legend('User 1', 'User 2', 'User 3', 'User 4');

subplot(2, 1, 2);
stem(timeSlots, receivedData');
title('Received Data');
xlabel('Time (s)'); ylabel('Data');
legend('User 1', 'User 2', 'User 3', 'User 4');

disp(['Bit Error Rate: ', num2str(bitErrorRate)]);</code></pre>
                </div>
                
                <h3>Part 2: FDMA - Frequency Division Multiple Access</h3>
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>% FDMA Simulation
clc; clear; close all;

% System parameters
totalBandwidth = 10e6; % Total available bandwidth (Hz)
numUsers = 5; % Number of users
carrierFrequency = 1e6; % Carrier frequency (Hz)
userBandwidth = totalBandwidth / numUsers; % Bandwidth allocated to each user (Hz)

% Time parameters
samplingFrequency = 100e6; % Sampling frequency (Hz)
timeDuration = 1e-3; % Simulation duration (s)
time = 0:1/samplingFrequency:timeDuration;

% Generate user signals
userSignals = zeros(numUsers, length(time));
for i = 1:numUsers
    userFrequency = carrierFrequency + (i-1) * userBandwidth;
    userSignals(i, :) = sin(2*pi*userFrequency*time);
end

% Create the FDMA signal
fdmaSignal = sum(userSignals, 1);

% Add noise to the FDMA signal
snr = 10; % Signal-to-Noise Ratio (in dB)
noisySignal = awgn(fdmaSignal, snr, 'measured');

% Perform signal demodulation
demodulatedSignals = zeros(numUsers, length(time));
for i = 1:numUsers
    userFrequency = carrierFrequency + (i-1) * userBandwidth;
    demodulatedSignals(i, :) = noisySignal .* sin(2*pi*userFrequency*time);
end

% Plot the original user signals and the demodulated signals
figure;
subplot(numUsers+1, 1, 1);
plot(time, fdmaSignal);
title('FDMA Signal');
xlabel('Time (s)'); ylabel('Amplitude');

for i = 1:numUsers
    subplot(numUsers+1, 1, i+1);
    plot(time, demodulatedSignals(i, :));
    title(['Demodulated Signal - User ', num2str(i)]);
    xlabel('Time (s)'); ylabel('Amplitude');
end</code></pre>
                </div>
                
                <h3>Part 3: CDMA - Code Division Multiple Access</h3>
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>% CDMA Simulation
clc; clear; close all;

% CDMA Simulation Parameters
numBits = 1000; % Number of bits per user
chipRate = 1e6; % Chip rate (chips per second)
snr = 10;

% Generate random data bits for User 1 and User 2
user1Bits = randi([0, 1], 1, numBits);
user2Bits = randi([0, 1], 1, numBits);

% BPSK Modulation
user1Symbols = 2 * user1Bits - 1; % Map 0s to -1 and 1s to 1
user2Symbols = 2 * user2Bits - 1;

% Chip-level Spreading (using a simple chip sequence)
chipSequence = [1, -1, 1, 1, -1, 1, -1, -1]; % Chip sequence for spreading
user1SpreadSymbols = kron(user1Symbols, chipSequence);
user2SpreadSymbols = kron(user2Symbols, chipSequence);

% Add AWGN (Additive White Gaussian Noise)
noiseVar = 10^(-snr/10); % Noise variance
user1NoisySymbols = user1SpreadSymbols + sqrt(noiseVar/2) * randn(1, length(user1SpreadSymbols));
user2NoisySymbols = user2SpreadSymbols + sqrt(noiseVar/2) * randn(1, length(user2SpreadSymbols));

% Matched Filtering (correlation with chip sequence)
user1FilteredSymbols = filter(fliplr(chipSequence), 1, user1NoisySymbols);
user2FilteredSymbols = filter(fliplr(chipSequence), 1, user2NoisySymbols);

% Symbol Detection (using correlation with chip sequence)
user1DetectedBits = user1FilteredSymbols(1:length(user1Symbols)) > 0;
user2DetectedBits = user2FilteredSymbols(1:length(user2Symbols)) > 0;

% Bit Error Rate (BER) Calculation
berUser1 = sum(user1DetectedBits ~= user1Bits) / numBits;
berUser2 = sum(user2DetectedBits ~= user2Bits) / numBits;

% Display results
disp(['User 1 BER: ', num2str(berUser1)]);
disp(['User 2 BER: ', num2str(berUser2)]);</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>User 1 BER: 0.538
User 2 BER: 0.495</pre>
                </div>
            </div>

            <!-- EXPERIMENT 8 -->
            <div class="experiment" id="exp8">
                <h2>EXPERIMENT 8</h2>
                <div class="aim">
                    <strong>Aim:</strong> To compute Mean Excess Delay, RMS Delay Spread, and Coherence Bandwidth.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>clc; clear; close all;
disp('--- Power Delay Profile (PDP) Analysis ---');
tau = input('Enter the path delays [in Î¼s] as a vector (e.g., [0 1 2 5]): ');
P_dB = input('Enter the corresponding powers [in dB] (e.g., [-20 -10 -10 0]): ');

% Check that the lengths match
if length(tau) ~= length(P_dB)
    error('Error: The number of delay values must match the number of power values.');
end

% Convert dB to linear scale
P = 10.^(P_dB / 10);

% Mean excess delay
tau_mean = sum(P .* tau) / sum(P);

% Second moment of delay
tau_sq_mean = sum(P .* tau.^2) / sum(P);

% RMS delay spread
tau_rms = sqrt(tau_sq_mean - tau_mean^2);

% Coherence bandwidth (50% correlation)
Bc = 1 / (5 * tau_rms); % in MHz (since tau is in Î¼s)
Bc = Bc * 1e6; % convert to Hz

% Display results
fprintf('\n--- Computed Results ---\n');
fprintf('Mean Excess Delay = %.3f Î¼s\n', tau_mean);
fprintf('RMS Delay Spread = %.3f Î¼s\n', tau_rms);
fprintf('Coherence BW (50%%) = %.2f kHz\n', Bc/1e3);

% Suitability check
if Bc >= 30e3
    fprintf('âœ“ Suitable for AMPS (>=30 kHz)\n');
else
    fprintf('âœ— Not suitable for AMPS\n');
end

if Bc >= 200e3
    fprintf('âœ“ Suitable for GSM (>=200 kHz)\n');
else
    fprintf('âœ— Not suitable for GSM\n');
end

% --- Optional: Plot Power Delay Profile (in dB) ---
figure;
stem(tau, P_dB, 'filled', 'LineWidth', 1.5);
xlabel('Delay (Î¼s)');
ylabel('Power (dB)');
title('Power Delay Profile (PDP)');
grid on;
set(gcf, 'Color', 'w');</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>--- Power Delay Profile (PDP) Analysis ---
Enter the path delays [in Î¼s] as a vector (e.g., [0 1 2 5]): [0 1 2 5]
Enter the corresponding powers [in dB] (e.g., [-20 -10 -10 0]): [-20 -10 -10 0]

--- Computed Results ---
Mean Excess Delay = 4.380 Î¼s
RMS Delay Spread = 1.374 Î¼s
Coherence BW (50%) = 145.54 kHz
âœ“ Suitable for AMPS (>=30 kHz)
âœ— Not suitable for GSM</pre>
                </div>
            </div>

            <!-- EXPERIMENT 9 -->
            <div class="experiment" id="exp9">
                <h2>EXPERIMENT 9</h2>
                <div class="aim">
                    <strong>Aim:</strong> To analyze Multipath Baseband Simulation and Frequency Spectrum Analysis.
                </div>
                
                <div class="code-container">
                    <div class="code-header">
                        <span>MATLAB Code</span>
                        <button class="copy-btn" onclick="copyCode(this)">Copy Code</button>
                    </div>
                    <pre><code>% Multipath baseband simulation with magnitude, phase, printed values, and frequency spectrum
clear; close all; clc;

% Given parameters
fc = 850e6; % carrier frequency (Hz)
% Multipath delays (ns â†’ s)
delays_ns = [201, 513, 819, 1223];
delays = delays_ns * 1e-9;

% Exact complex coefficients
a = [0.59+1j*0.81, 0.59-1j*0.81, 0.18-1j*0.24, -0.19+1j*0.06];

% Transmitted baseband sb(t): rectangular pulse 0 â†’ 0.5 Î¼s
pulse_start = 0;
pulse_end = 0.5e-6;
Fs = 200e6; % sampling frequency (Hz)
dt = 1/Fs;
t = -1e-6 : dt : 4e-6; % time vector (covers before & after multipath)

% Transmitted pulse
sb = double((t >= pulse_start) & (t <= pulse_end));

% Initialize received signal yb(t)
yb = complex(zeros(size(sb)));

% Generate received signal
for k = 1:length(a)
    tau = delays(k);
    shift_samples = round(tau / dt);
    if shift_samples >= 0
        shifted = [zeros(1,shift_samples), sb(1:end-shift_samples)];
    else
        s = -shift_samples;
        shifted = [sb(s+1:end), zeros(1,s)];
    end
    yb = yb + a(k) * shifted;
end

% --- Plot Section ---
% 1. Transmitted baseband pulse
figure;
plot(t*1e6, real(sb), 'LineWidth', 1.5);
grid on;
xlabel('Time (\mus)');
ylabel('Amplitude');
title('Transmitted Baseband s_b(t)');
set(gcf, 'Color', 'w');

% 2. Received signal magnitude
figure;
plot(t*1e6, abs(yb), 'LineWidth', 1.5);
grid on;
xlabel('Time (\mus)');
ylabel('|y_b(t)|');
title('Received Baseband Magnitude |y_b(t)|');
set(gcf, 'Color', 'w');

% 3. Received signal real part
figure;
plot(t*1e6, real(yb), 'LineWidth', 1.2);
grid on;
xlabel('Time (\mus)');
ylabel('Real(y_b(t))');
title('Real Part of Received Signal');
set(gcf, 'Color', 'w');

% 4. Channel coefficients: Magnitude and Phase plots
mag = abs(a);
phase_deg = angle(a) * 180/pi;

figure;
subplot(2,1,1);
stem(delays_ns, mag, 'filled', 'LineWidth', 1.3);
xlabel('Delay (ns)');
ylabel('Magnitude');
title('Multipath Component Magnitude');
grid on;

subplot(2,1,2);
stem(delays_ns, phase_deg, 'filled', 'LineWidth', 1.3);
xlabel('Delay (ns)');
ylabel('Phase (Â°)');
title('Multipath Component Phase');
grid on;
set(gcf, 'Color', 'w');

% --- Print magnitude and phase values ---
fprintf('\nMultipath Component Details:\n');
fprintf('------------------------------------------------------------\n');
fprintf('Path | Delay (ns) | Complex Coefficient (a_k) | Magnitude | Phase (deg)\n');
fprintf('------------------------------------------------------------\n');
for k = 1:length(a)
    fprintf(' %d   | %7.0f    | %8.3f %+.3fj        | %7.4f   | %7.2fÂ°\n', ...
        k, delays_ns(k), real(a(k)), imag(a(k)), mag(k), phase_deg(k));
end
fprintf('------------------------------------------------------------\n');

% 5. Frequency-domain analysis of received signal
N = length(yb);
YB = fftshift(fft(yb, N)); % centered FFT
f = (-N/2:N/2-1)*(Fs/N)/1e6; % frequency vector in MHz
YB_mag = abs(YB)/max(abs(YB)); % normalize magnitude

figure;
plot(f, 20*log10(YB_mag + eps), 'LineWidth', 1.3);
xlabel('Frequency (MHz)');
ylabel('Magnitude (dB)');
title('Frequency Spectrum of Received Baseband Signal |Y_b(f)|');
grid on;
xlim([-100 100]); % show Â±100 MHz around baseband
set(gcf, 'Color', 'w');</code></pre>
                </div>
                
                <div class="output">
                    <h4>Sample Output:</h4>
                    <pre>Multipath Component Details:
------------------------------------------------------------
Path | Delay (ns) | Complex Coefficient (a_k) | Magnitude | Phase (deg)
------------------------------------------------------------
 1   |     201    |    0.590 +0.810j        |  1.0021   |   53.93Â°
 2   |     513    |    0.590 -0.810j        |  1.0021   |  -53.93Â°
 3   |     819    |    0.180 -0.240j        |  0.3000   |  -53.13Â°
 4   |    1223    |   -0.190 +0.060j        |  0.1992   |  162.47Â°
------------------------------------------------------------</pre>
                </div>
            </div>
        </div>
        
        <footer>
            <p>&copy; 2024 Wireless Communication Lab Experiments | Complete MATLAB Code Collection</p>
        </footer>
    </div>

    <script>
        function scrollToExp(num) {
            const element = document.getElementById('exp' + num);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function copyCode(button) {
            const codeBlock = button.parentElement.nextElementSibling.querySelector('code');
            const text = codeBlock.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                
                setTimeout(() => {
                    button.textContent = 'Copy Code';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }
    </script>
</body>
</html>
